current focus: react client development - ready for web application

## phase 0: architecture transition (completed 2025-01-24)
- [x] removed terminal cli package
  - [x] deleted packages/cli completely 
  - [x] removed ink dependencies
  - [x] updated root package.json scripts
- [x] persistence layer implementation
  - [x] GameStateRepository with sqlite/postgresql support
  - [x] redis session management with database fallback
  - [x] complete sql schema with indexing and cleanup
  - [x] serializable game state types
- [x] rest api server
  - [x] bun-powered server with cors support
  - [x] player management endpoints
  - [x] session management endpoints
  - [x] health check and error handling
- [x] documentation updates
  - [x] updated readme with api documentation
  - [x] database setup instructions
  - [x] removed cli references

## phase 1: foundational architecture & core combat (completed)
- [x] core game architecture (2025-01-23)
  - [x] game state management (zustand)
  - [x] event system for game mechanics
  - [x] entity-component system for characters/enemies
  - [x] zone/area management system
  - [x] unit tests for all core systems
- [x] character system foundation (2025-01-23)
  - [x] base attributes (str/dex/int)
  - [x] derived stats (life/mana/evasion/armor)
  - [x] 7 character classes with proper stat distributions
  - [x] character persistence to database
  - [x] unit tests for stat calculations
- [x] combat engine (2025-01-23)
  - [x] tick-based combat (100ms resolution)
  - [x] damage calculation pipeline (base -> conversion -> mitigation)
  - [x] hit/evasion/accuracy calculations
  - [x] critical strike system
  - [x] position system (melee/close/far)
  - [x] combat log with detailed calculations
  - [x] unit tests for all combat formulas
- [x] damage & defense systems (2025-01-23)
  - [x] damage types (physical/fire/cold/lightning/chaos)
  - [x] resistance system (-60% to 75% cap)
  - [x] armor/evasion/energy shield mechanics
  - [x] damage over time framework
  - [x] unit tests for mitigation calculations

## phase 2: items & loot system (completed)
- [x] item architecture (2025-01-23)
  - [x] base item types system
    - [x] weapon types (axes, swords, maces, daggers, claws, bows, staves, scepters, wands)
    - [x] armor types (helmets, body armor, gloves, boots, shields)
    - [x] jewelry types (rings, amulets, belts)
    - [x] flask types (life, mana, hybrid, utility)
  - [x] affix system using item-affixes.json
    - [x] prefix pool (offensive modifiers)
    - [x] suffix pool (defensive modifiers)
    - [x] tier-based affix selection by item level
    - [x] affix value range rolling
  - [x] item rarity tiers
    - [x] normal: no affixes
    - [x] magic: 1 prefix and/or 1 suffix
    - [x] rare: up to 3 prefixes and 3 suffixes
    - [x] unique: fixed special modifiers (future)
  - [x] item level and requirement system
    - [x] item level determines available affixes
    - [x] stat requirements (str/dex/int) from base types
    - [x] level requirements from affixes
  - [x] unit tests for item generation
- [x] equipment system (2025-01-23)
  - [x] equipment slots
    - [x] main hand (all weapon types)
    - [x] off hand (shields, dual wield)
    - [x] helm, body armor, gloves, boots
    - [x] belt, amulet, ring left, ring right
  - [x] stat aggregation from equipment
    - [x] sum all affix modifiers
    - [x] apply percentage increases
    - [x] calculate final stats
  - [x] item comparison system
  - [x] unit tests for equipment bonuses
- [x] loot generation (2025-01-23)
  - [x] simplified archetype-based monster system (physical/caster/ranged/mixed)
  - [x] level-scaling currency drops (all currency available, exponentially weighted by level)
  - [x] rarity-based drop quantity scaling (normal 0-2, magic 1-3, rare 2-5, unique 3-7 items)
  - [x] cross-act monster registry system (define once, use everywhere)
  - [x] zone spawn table system (easy monster-to-zone mapping)
  - [x] IIQ/IIR affix support for rings/jewelry (quantity/rarity find modifiers)
  - [x] integration with combat engine (async loot generation on monster death)
  - [x] comprehensive unit tests with PoE validation (24 tests across 3 files, 114+ expect calls)

## phase 3: missing core game features
- [x] extended item variety (2025-01-24)
  - [x] add missing weapon types (maces, scepters, two-handed axes/maces)
  - [x] add more base types per category (20+ variants)
  - [x] add missing armor slots (more glove/boot variants)
  - [x] add utility flask types (quicksilver, granite, jade, etc.)
  - [x] add quivers for bow users
  - [x] add jewel types (crimson, viridian, cobalt, prismatic)
- [ ] unique items system
  - [ ] unique item definitions with fixed affixes
  - [ ] unique item generation from pool
  - [ ] famous uniques (tabula rasa, headhunter, etc.)
  - [ ] unique item drop weighting
  - [ ] unit tests for unique generation
- [ ] item socket system
  - [ ] socket mechanics on items
    - [ ] socket count (1-6 based on item type)
      - [ ] 1h weapons: max 3 sockets
      - [ ] 2h weapons: max 6 sockets
      - [ ] body armor: max 6 sockets
      - [ ] helmet/gloves/boots: max 4 sockets
      - [ ] shields: max 3 sockets
    - [ ] socket colors (red/str, green/dex, blue/int, white)
    - [ ] socket color rolling based on item requirements
    - [ ] white sockets (accepts any color gem)
    - [ ] corrupted sockets (cannot be modified)
  - [ ] socket linking system
    - [ ] links between adjacent sockets (visual groups)
    - [ ] max links based on item (6L for 2h/body, 4L for helm/gloves/boots, 3L for 1h/shield)
    - [ ] link groups (2L, 3L, 4L, 5L, 6L configurations)
    - [ ] multiple link groups per item (e.g., 4L + 2L on body armor)
  - [ ] socket crafting with currency
    - [ ] chromatic orb: reroll socket colors
    - [ ] jeweller's orb: reroll socket count
    - [ ] orb of fusing: reroll socket links
    - [ ] vaal orb: corrupt item (lock sockets)
    - [ ] crafting bench recipes for deterministic sockets
  - [ ] unit tests for socket system
- [ ] skill gem system
  - [ ] gem as items
    - [ ] gems are inventory items that socket into equipment
    - [ ] gem data structure (id, name, color, tags, requirements)
    - [ ] gem level (1-20) and quality (0-20%)
    - [ ] corrupted gems (21 level, 23% quality, vaal versions)
    - [ ] attribute requirements scaling with level
    - [ ] experience system for gems (gain xp when socketed)
  - [ ] active skill gems
    - [ ] attack skills
      - [ ] melee: cleave, ground slam, heavy strike, cyclone, molten strike
      - [ ] ranged: split arrow, lightning arrow, ice shot, barrage
    - [ ] spell skills
      - [ ] projectile: fireball, freezing pulse, spark, ball lightning
      - [ ] aoe: firestorm, ice nova, arc, blade vortex
      - [ ] channeled: incinerate, scorching ray, winter orb, divine ire
    - [ ] movement skills
      - [ ] leap slam, shield charge, whirling blades (attack-based)
      - [ ] flame dash, lightning warp, frostblink (spell-based)
      - [ ] dash, blink arrow (generic/bow)
    - [ ] aura skills (reserve mana)
      - [ ] offensive: anger, wrath, hatred, zealotry
      - [ ] defensive: determination, grace, discipline, purity elements
      - [ ] utility: clarity, vitality, precision, haste
    - [ ] warcry skills
      - [ ] enduring cry, rallying cry, intimidating cry, seismic cry
    - [ ] guard skills
      - [ ] molten shell, steelskin, immortal call, bone armor
    - [ ] totem/minion skills
      - [ ] spell totem, decoy totem, ancestral warchief
      - [ ] raise zombie, raise spectre, summon skeletons
  - [ ] support gems
    - [ ] support gem structure (similar to active)
    - [ ] must be linked to compatible active gem
    - [ ] tag matching system (spell, attack, aoe, projectile, melee, etc.)
    - [ ] mana multiplier effects (increase mana cost)
  - [ ] support gem types
    - [ ] damage supports
      - [ ] melee physical damage, elemental damage with attacks
      - [ ] spell echo, controlled destruction, elemental focus
      - [ ] added fire/cold/lightning/chaos damage
    - [ ] critical supports
      - [ ] increased critical strikes, increased critical damage
    - [ ] speed supports
      - [ ] faster attacks, faster casting, multistrike, spell echo
    - [ ] utility supports
      - [ ] life leech, mana leech, blind, fortify
      - [ ] chain, fork, pierce, greater multiple projectiles
      - [ ] increased area of effect, concentrated effect
    - [ ] trigger supports
      - [ ] cast on critical strike, cast when damage taken
      - [ ] cast on death, cast while channelling
  - [ ] gem socketing rules
    - [ ] gem color must match socket color (or white socket)
    - [ ] multiple active gems allowed per link group
    - [ ] each active gem uses supports independently (all golems in 4L helm each get the supports)
    - [ ] supports affect all compatible linked active gems in same group
    - [ ] vaal gems grant both regular and vaal version
  - [ ] skill usage from socketed gems
    - [ ] scan all equipped items for socketed active gems
    - [ ] calculate final skill properties from linked supports
    - [ ] apply support gem modifiers in correct order
    - [ ] handle mana cost multipliers from supports
    - [ ] skill bar populated from socketed actives
  - [ ] gem progression
    - [ ] gems gain experience when socketed and used
    - [ ] level requirements increase with gem level
    - [ ] attribute requirements scale with level
    - [ ] damage/effect scaling per level
    - [ ] quality bonuses (different per gem)
  - [ ] gem vendor recipes
    - [ ] level 20 gem + gcp = level 1, 20% quality
    - [ ] gem + orb of scouring = level 1 gem
    - [ ] vendoring gems for currency shards
  - [ ] unit tests for gem system
- [ ] class-specific mechanics
  - [ ] starting skills per class
  - [ ] class-specific passives (future)
  - [ ] ascendancy mechanics (future)
  - [ ] class quest rewards
- [ ] integration tests
  - [ ] full combat scenarios with multiple enemies
  - [ ] boss battle simulations
  - [ ] pvp battle tests
  - [ ] loot drop integration tests
  - [ ] equipment swap battle tests
  - [ ] skill rotation tests
  - [ ] damage type interaction tests

## phase 4: passive skill tree & progression system (completed zone system foundation)
- [ ] passive tree data structure
  - [ ] node types system
    - [ ] small nodes (+10 to attribute, 4% life, etc.)
    - [ ] notable nodes (larger bonuses, named nodes)
    - [ ] keystone nodes (powerful effects with drawbacks)
    - [ ] jewel sockets (slots for jewel items)
  - [ ] tree layout & connections
    - [ ] node positioning (x, y coordinates)
    - [ ] connection paths between nodes
    - [ ] class starting positions (7 start points)
    - [ ] ~300-400 total nodes (simplified from poe's 1300+)
  - [ ] node data definitions
    - [ ] unique node ids
    - [ ] stat modifiers per node
    - [ ] node groups/clusters (life cluster, crit cluster, etc.)
    - [ ] radius/area bonuses from jewels
  - [ ] tree data json structure
    - [ ] nodes.json with all node definitions
    - [ ] connections.json for node paths
    - [ ] starting-positions.json per class
  - [ ] unit tests for tree structure validation
- [ ] passive allocation system
  - [ ] allocation tracking
    - [ ] allocated node ids per character
    - [ ] available skill points tracking
    - [ ] spent vs available points
  - [ ] path validation
    - [ ] must connect to starting position
    - [ ] can only allocate connected nodes
    - [ ] path finding algorithm for validation
    - [ ] prevent disconnected allocations
  - [ ] stat aggregation
    - [ ] sum all allocated node stats
    - [ ] apply to character base stats
    - [ ] handle percentage vs flat bonuses
    - [ ] proper stat stacking order
  - [ ] respec system
    - [ ] refund single points (orb of regret)
    - [ ] full respec option (testing)
    - [ ] respec cost tracking
    - [ ] maintain valid paths during respec
  - [ ] unit tests for allocation logic
- [ ] experience & level progression
  - [ ] experience system
    - [ ] experience requirements per level (1-100)
    - [ ] experience penalties for level difference
    - [ ] experience gain from monster kills
    - [ ] party experience sharing (future)
  - [ ] level up mechanics
    - [ ] level up event firing
    - [ ] skill point reward (1 per level)
    - [ ] stat increases per level
    - [ ] health/mana refill on level
  - [ ] skill point sources
    - [ ] level ups (99 points max)
    - [ ] quest rewards (~20 points)
    - [ ] bandit choices (0-2 points)
    - [ ] total ~120 points available
  - [ ] progression tracking
    - [ ] current level and experience
    - [ ] experience to next level
    - [ ] total skill points earned
    - [ ] quest completion tracking
  - [ ] unit tests for experience calculations
- [x] zone system implementation (2025-01-24)
  - [x] dynamic zone generation system with 5 procedural generators
  - [x] text-based grid navigation with ascii map visualization  
  - [x] dynamic monster generation with smart spawn placement
  - [x] 10 predefined zone templates across 5 acts (levels 1-60)
  - [x] waypoint discovery system and zone state management
  - [x] comprehensive testing with 66 tests validating all functionality
  - [x] hazards removed from system (annoying for text games)
  - [x] npc vendor system for towns with 6 vendor types
  - [x] towns are proper safe zones (no monsters, no chests, only npcs)
  - [ ] town npcs and vendors
    - [ ] act 1 town - lioneye's watch
      - [ ] nessa - sells gems and flasks
      - [ ] tarkleigh - sells weapons and armor
      - [ ] bestel - quest giver, lore
    - [ ] act 2 town - forest encampment  
      - [ ] yeena - sells gems and jewelry
      - [ ] greust - sells weapons and armor
      - [ ] silk - quest giver, bandit choices
      - [ ] eramir - flask and currency vendor
    - [ ] act 3 town - sarn encampment
      - [ ] clarissa - sells gems and wands
      - [ ] hargan - sells weapons and unique items
      - [ ] grigor - sells armor and shields
      - [ ] maramoa - quest giver
    - [ ] act 4 town - highgate
      - [ ] kira - sells gems and support gems
      - [ ] petarus & vanja - sell weapons and armor
      - [ ] tasuni - unique items and prophecies
      - [ ] oyun - quest giver
    - [ ] act 5 town - overseer's tower
      - [ ] lani - sells all gem types
      - [ ] vilenta - sells high level weapons
      - [ ] bannon - quest giver and rewards
      - [ ] utula - sells armor and accessories
    - [ ] vendor mechanics
      - [ ] item refresh on level up
      - [ ] currency exchange rates
      - [ ] vendor recipes (sell items for currency)
      - [ ] buyback recent sales
  - [ ] zone templates and generation
    - [ ] zone template structure
      - [ ] zone id and metadata
      - [ ] generator type (cave, dungeon, outdoor, city)
      - [ ] size range (min/max cells)
      - [ ] monster pool definition
      - [ ] boss configuration if applicable
      - [ ] environment theme and descriptions
    - [ ] monster pool templates
      - [ ] act 1 pools: zombies, skeletons, rhoas, goatmen, sirens
      - [ ] act 2 pools: bandits, apes, spiders, snakes, constructs
      - [ ] act 3 pools: blackguards, evangelists, undying, statues
      - [ ] act 4 pools: demons, miners, gladiators, kaom's warriors
      - [ ] act 5 pools: templars, oriath citizens, kitava's heralds
    - [ ] generation parameters
      - [ ] density: sparse (20%), normal (40%), dense (60%)
      - [ ] complexity: simple, moderate, complex layouts
      - [ ] special features: shrines, events, secrets
  - [ ] zone progression structure (5 acts)
    - [ ] act 1: the twilight strand to merveil (levels 1-12)
      - [ ] twilight strand (level 1) - tutorial, linear generator, sparse monsters, no waypoint
      - [ ] lioneye's watch (town) - static layout, safe zone, waypoint always active
      - [ ] the coast (level 2) - requires twilight strand completion
      - [ ] the tidal island (level 3) - optional side area from coast
      - [ ] the mud flats (level 4) - requires coast completion
      - [ ] the fetid pool (level 5) - optional side area from mud flats
      - [ ] the submerged passage (level 5) - requires mud flats completion
      - [ ] the flooded depths (level 6) - optional side area from passage
      - [ ] the ledge (level 7) - requires submerged passage
      - [ ] the climb (level 8) - requires ledge completion
      - [ ] the lower prison (level 9) - requires climb completion
      - [ ] the upper prison (level 10) - requires lower prison + brutus kill
      - [ ] prisoner's gate (level 11) - requires upper prison
      - [ ] the ship graveyard (level 12) - requires prisoner's gate
      - [ ] the cavern of wrath (level 12) - boss zone, requires ship graveyard
      - [ ] merveil's lair (level 12) - act boss, requires cavern clear, gates act 2
    - [ ] act 2: the forest to vaal oversoul (levels 13-23)
      - [ ] the southern forest (level 13) - requires act 1 completion
      - [ ] the forest encampment (town) - safe zone hub
      - [ ] the old fields (level 14) - requires forest encampment visit
      - [ ] the den (level 15) - optional side area from old fields
      - [ ] the crossroads (level 15) - requires old fields, branches to 3 paths
      - [ ] the chamber of sins level 1 (level 16) - path 1 from crossroads
      - [ ] the chamber of sins level 2 (level 17) - requires level 1 + fidelitas kill
      - [ ] the broken bridge (level 16) - path 2 from crossroads
      - [ ] the fellshrine ruins (level 16) - path 3 from crossroads
      - [ ] the crypt (level 17) - optional from fellshrine
      - [ ] the riverways (level 18) - requires all 3 paths complete
      - [ ] the western forest (level 19) - requires riverways
      - [ ] the weaver's chambers (level 20) - requires western + alira dealt with
      - [ ] the wetlands (level 21) - requires western + oak dealt with
      - [ ] the vaal ruins (level 22) - requires wetlands
      - [ ] the northern forest (level 23) - requires vaal ruins
      - [ ] the caverns (level 23) - requires northern forest
      - [ ] the ancient pyramid (level 23) - requires caverns
      - [ ] the vaal oversoul (level 23) - act boss, gates act 3
    - [ ] act 3: the city of sarn (levels 24-34)
      - [ ] the city of sarn (level 24) - requires act 2 completion
      - [ ] sarn encampment (town) - safe zone hub
      - [ ] the slums (level 25) - requires encampment visit
      - [ ] the crematorium (level 26) - requires slums + piety encounter
      - [ ] the sewers (level 27) - requires slums
      - [ ] the marketplace (level 28) - requires sewers
      - [ ] the catacombs (level 29) - optional from marketplace
      - [ ] the battlefront (level 29) - requires marketplace
      - [ ] the docks (level 30) - requires battlefront
      - [ ] the solaris temple level 1 (level 30) - requires battlefront
      - [ ] the solaris temple level 2 (level 31) - requires level 1
      - [ ] the ebony barracks (level 31) - requires docks
      - [ ] the lunaris temple level 1 (level 32) - requires ebony barracks
      - [ ] the lunaris temple level 2 (level 33) - requires level 1 + piety kill
      - [ ] the imperial gardens (level 33) - requires both temples complete
      - [ ] the sceptre of god (level 34) - requires gardens
      - [ ] the upper sceptre of god (level 34) - requires lower sceptre
      - [ ] dominus's tower (level 34) - act boss, gates act 4
    - [ ] act 4: highgate to the beast (levels 35-45)
      - [ ] the aqueduct (level 35) - requires act 3 completion
      - [ ] highgate (town) - safe zone hub
      - [ ] the dried lake (level 36) - requires highgate visit + voll kill
      - [ ] the mines level 1 (level 37) - requires dried lake
      - [ ] the mines level 2 (level 38) - requires level 1
      - [ ] the crystal veins (level 39) - requires mines level 2
      - [ ] daresso's dream (level 40) - path 1 from crystal veins
      - [ ] the grand arena (level 41) - requires daresso's dream
      - [ ] daresso's pit (level 42) - requires grand arena + daresso kill
      - [ ] kaom's dream (level 40) - path 2 from crystal veins
      - [ ] kaom's path (level 41) - requires kaom's dream
      - [ ] kaom's stronghold (level 42) - requires path + kaom kill
      - [ ] the belly of the beast level 1 (level 43) - requires both paths
      - [ ] the belly of the beast level 2 (level 44) - requires level 1
      - [ ] the harvest (level 45) - requires belly level 2
      - [ ] the black core (level 45) - act boss (malachai), gates act 5
    - [ ] act 5: return to oriath (levels 46-60)
      - [ ] the slave pens (level 46) - requires act 4 completion
      - [ ] overseer's tower (town) - safe zone hub
      - [ ] the control blocks (level 47) - requires tower visit
      - [ ] oriath square (level 48) - requires control blocks
      - [ ] the templar courts (level 49) - requires square
      - [ ] the chamber of innocence (level 50) - requires courts + innocence kill
      - [ ] the torched courts (level 51) - requires chamber
      - [ ] the ruined square (level 52) - requires torched courts
      - [ ] the reliquary (level 53) - optional from ruined square
      - [ ] the ossuary (level 54) - requires ruined square
      - [ ] the cathedral rooftop (level 55) - requires ossuary
      - [ ] the cathedral apex (level 56) - requires rooftop + avarius kill
      - [ ] the blood aqueduct (level 57) - requires apex
      - [ ] the descent (level 58) - requires blood aqueduct
      - [ ] the overseer's chamber (level 59) - requires descent
      - [ ] the templar laboratory (level 60) - final zone
      - [ ] the final encounter (level 60) - act boss (kitava), game completion
  - [ ] zone prerequisite system
    - [ ] entry requirements structure
      - [ ] previous zone completion flag
      - [ ] minimum character level
      - [ ] required boss defeats
      - [ ] required quest completions
      - [ ] required item possessions (keys, etc.)
    - [ ] progression gating
      - [ ] act bosses must be defeated to progress
      - [ ] certain zones require multiple prerequisites
      - [ ] optional zones have softer requirements
      - [ ] death in boss zones respawns in town
    - [ ] zone connection graph
      - [ ] directed graph of zone connections
      - [ ] multiple entry/exit points for some zones
      - [ ] one-way connections (drops, portals)
      - [ ] waypoint network for fast travel
  - [ ] text-based zone structure
    - [ ] zone metadata
      - [ ] unique zone id (e.g., "act1_coast")
      - [ ] display name (e.g., "The Coast")
      - [ ] zone level (monster level)
      - [ ] zone type (outdoor, indoor, town, boss)
      - [ ] zone description (atmospheric text shown on entry)
    - [ ] grid-based navigation
      - [ ] player position (x, y) on zone grid
      - [ ] grid size per zone (10x10, 15x15, 20x20)
      - [ ] room/cell descriptions based on position
      - [ ] movement commands (n/s/e/w) move one cell
      - [ ] blocked cells (walls, obstacles)
      - [ ] zone exit cells marked on specific edges
    - [ ] dynamic monster generation
      - [ ] monster pool per zone
        - [ ] zone-appropriate monster types
        - [ ] 3-5 different monster species per zone
        - [ ] level-scaled monster stats
        - [ ] thematic consistency (undead in crypts, beasts in forests)
      - [ ] procedural pack generation
        - [ ] pack composition algorithm
        - [ ] mixed packs (e.g., 2 archers + 3 melee)
        - [ ] pack size: 1-3 (normal), 2-4 (magic), 3-5 (rare)
        - [ ] pack leader determination
        - [ ] affix generation for magic/rare packs
      - [ ] dynamic spawn placement
        - [ ] spawn density based on zone difficulty
        - [ ] clustering algorithm for pack placement
        - [ ] guard spawns near objectives
        - [ ] ambush spawns in dead ends
        - [ ] patrol paths for some packs
      - [ ] encounter scaling
        - [ ] total packs: 20-80% of walkable cells
        - [ ] champion/rare chance: 10-20% of packs
        - [ ] elite pack modifiers (fast, tanky, regenerating)
        - [ ] boss with random affixes in boss zones
      - [ ] encounter descriptions
        - [ ] procedural description generation
        - [ ] "A pack of [2-5] [monster type] [action verb]"
        - [ ] special descriptions for rare/unique monsters
        - [ ] environmental context in descriptions
    - [ ] waypoint system
      - [ ] has waypoint (boolean)
      - [ ] waypoint position (x, y) on grid
      - [ ] waypoint unlocks at 50% zone cleared
      - [ ] waypoint visible when player at same position
      - [ ] waypoint command: "use waypoint" or "wp"
      - [ ] shows list of discovered waypoints to travel to
    - [ ] text-based zone features
      - [ ] room hazards
        - [ ] hazard descriptions in room text
        - [ ] "The ground here burns with unholy fire"
        - [ ] "Pools of tar slow your movement"
        - [ ] hazard effects during combat
      - [ ] interactable objects
        - [ ] examine/search commands reveal objects
        - [ ] "open chest", "activate shrine", "pull lever"
        - [ ] loot appears in room after combat
        - [ ] quest items found via search
      - [ ] zone atmosphere
        - [ ] room ambiance descriptions
        - [ ] weather/lighting text
        - [ ] sound descriptions
    - [ ] dynamic map generation
      - [ ] procedural zone shapes
        - [ ] room-and-corridor generator (dungeons)
        - [ ] organic cave generator (natural areas)
        - [ ] street grid generator (towns/cities)
        - [ ] maze generator (complex areas)
        - [ ] minimum walkable cells per zone size
      - [ ] dynamic grid boundaries
        - [ ] non-rectangular zone shapes
        - [ ] sparse grid (only store walkable cells)
        - [ ] connected component validation
        - [ ] ensure all areas reachable
      - [ ] cell generation rules
        - [ ] terrain type based on zone theme
        - [ ] obstacle placement algorithm
        - [ ] hazard distribution patterns
        - [ ] chest/container spawn points
      - [ ] navigation system
        - [ ] movement: n/s/e/w between connected cells
        - [ ] look: describes current cell and visible adjacent
        - [ ] map: ascii visualization of discovered area
        - [ ] pathfinding for exit/waypoint hints
      - [ ] zone flow control
        - [ ] entry point generation
        - [ ] exit point placement (multiple possible)
        - [ ] waypoint placement at 30-70% through zone
        - [ ] boss arena generation for boss zones
  - [ ] zone state management
    - [ ] instance creation
      - [ ] new instance on first entry
      - [ ] instance timeout (15 minutes)
      - [ ] instance reset on re-entry after timeout
      - [ ] party instances (future)
    - [ ] zone progression tracking
      - [ ] pack clear tracking
        - [ ] total packs in zone
        - [ ] packs killed count
        - [ ] zone completion percentage (killed/total)
        - [ ] waypoint unlock at 50% packs cleared
      - [ ] individual monster tracking
        - [ ] monsters per pack killed
        - [ ] rare/unique kills
        - [ ] experience gained
      - [ ] mini-map exploration
      - [ ] quest objectives completed
    - [ ] waypoint system
      - [ ] waypoint unlocks at 50% zone clear automatically
      - [ ] waypoint network saved per character
      - [ ] town waypoints always active
      - [ ] fast travel between unlocked waypoints
      - [ ] waypoint ui shows all discovered waypoints by act
  - [ ] quest integration
    - [ ] main story quests
      - [ ] kill act boss quests
      - [ ] find item quests
      - [ ] rescue npc quests
      - [ ] unlock new area quests
    - [ ] skill point reward quests
      - [ ] 2-3 skill point quests per act
      - [ ] optional but highly valuable
      - [ ] quest state saved per character
    - [ ] quest tracking
      - [ ] active quest list
      - [ ] completed quest history
      - [ ] quest objectives and hints
      - [ ] quest reward claiming
  - [ ] unit tests for zone system
    - [ ] zone prerequisite validation
    - [ ] progression path testing
    - [ ] instance management testing
    - [ ] waypoint network testing
- [ ] skill system integration
  - [ ] skill point requirements
    - [ ] active skill gems need sockets
    - [ ] support gems need links
    - [ ] skill levels (1-20)
    - [ ] quality bonuses (0-20%)
  - [ ] skill progression
    - [ ] experience for skill gems
    - [ ] level requirements
    - [ ] attribute requirements
    - [ ] skill damage scaling
  - [ ] skill bar system
    - [ ] 8 active skill slots
    - [ ] default attack always available
    - [ ] flask slots (5)
    - [ ] movement skill slot
  - [ ] skill interactions
    - [ ] support gem combinations
    - [ ] trigger gems (cast on crit, etc.)
    - [ ] aura/buff management
    - [ ] cooldown tracking
  - [ ] unit tests for skill usage
- [ ] integration tests - full gameplay simulation
  - [ ] character progression simulation
    - [ ] create character (class selection)
    - [ ] enter first zone
    - [ ] fight monsters using skills
    - [ ] gain experience and level up
    - [ ] allocate passive points
    - [ ] verify stat changes
    - [ ] equip items found
    - [ ] progress to next zone
  - [ ] combat with passive tree effects
    - [ ] verify damage increases from tree
    - [ ] verify defense bonuses apply
    - [ ] test critical strike nodes
    - [ ] test elemental damage nodes
    - [ ] test life/mana nodes
  - [ ] different build paths testing
    - [ ] melee physical build simulation
    - [ ] spell caster build simulation
    - [ ] bow/ranged build simulation
    - [ ] tank/defensive build simulation
    - [ ] hybrid build simulation
  - [ ] full act progression test
    - [ ] complete act 1 zones
    - [ ] defeat act boss
    - [ ] complete skill point quests
    - [ ] verify proper level progression
    - [ ] test death penalties
  - [ ] edge cases and validation
    - [ ] test invalid allocation attempts
    - [ ] test respec mechanics
    - [ ] test disconnected path prevention
    - [ ] test maximum level (100)
    - [ ] test quest reward limits

## phase 5: react client foundation
- [ ] react application setup
  - [ ] next.js or vite setup with typescript
  - [ ] tailwind css for styling
  - [ ] api client integration (fetch/axios)
  - [ ] zustand for client state management
  - [ ] react query for server state
- [ ] authentication & sessions
  - [ ] simple auth system (username-based)
  - [ ] session management with api
  - [ ] player selection screen
  - [ ] character creation flow
- [ ] basic ui components
  - [ ] button, input, modal components
  - [ ] game layout with sidebar
  - [ ] responsive design for desktop
  - [ ] loading states and error handling

## phase 5: game interface implementation
- [ ] character sheet view
  - [ ] stats display (life, mana, resistances)
  - [ ] equipment visualization
  - [ ] character class information
  - [ ] level/experience progress
- [ ] inventory management
  - [ ] grid-based inventory interface
  - [ ] item tooltips with affix information
  - [ ] item comparison overlays
  - [ ] drag and drop equipment
- [ ] combat interface
  - [ ] combat log display
  - [ ] action buttons (attack, move, skills)
  - [ ] position indicators
  - [ ] enemy health/status

## phase 6: game mechanics ui
- [ ] zone/area system
  - [ ] zone selection interface  
  - [ ] zone progression tracking
  - [ ] monster encounter ui
  - [ ] loot pickup interface
- [ ] flask system
  - [ ] 5 flask slots ui
  - [ ] flask types (life/mana/utility)
  - [ ] flask modifiers display
  - [ ] charge generation visualization
- [ ] skill system interface
  - [ ] active skill selection
  - [ ] skill tooltips and descriptions
  - [ ] mana cost indicators
  - [ ] cooldown timers

## phase 7: advanced features
- [ ] crafting interface
  - [ ] currency orb usage
  - [ ] crafting bench ui
  - [ ] item modification preview
  - [ ] crafting history/results
- [ ] progression systems
  - [ ] experience tracking
  - [ ] passive skill tree (simplified)
  - [ ] ascendancy selection
  - [ ] level-up notifications

## phase 8: endgame systems
- [ ] map system interface
  - [ ] map selection and modifiers
  - [ ] atlas progression tracking
  - [ ] map rewards display
- [ ] league mechanics ui
  - [ ] league content indicators
  - [ ] challenge tracking
  - [ ] league-specific interfaces

## phase 9: multiplayer features
- [ ] party system interface
  - [ ] party formation ui
  - [ ] shared experience display
  - [ ] party member status
- [ ] trading system
  - [ ] trade window interface
  - [ ] currency exchange ui
  - [ ] trade history tracking
- [ ] chat system
  - [ ] chat channels interface
  - [ ] whisper system
  - [ ] chat commands

## api architecture (current)

### endpoints available
- `GET /api/players` - list all players
- `POST /api/players` - create new player  
- `GET /api/players/:id` - get player data
- `PUT /api/players/:id` - update player data
- `GET /api/sessions/:id` - get session data
- `PUT /api/sessions/:id` - update session data
- `DELETE /api/sessions/:id` - end session
- `GET /health` - server health check

### database support
- **development**: sqlite with `DB_PATH=./data/shimlar.db`
- **production**: postgresql with full schema
- **sessions**: redis-backed with database fallback
- **cleanup**: automatic expired session/data cleanup

### current package structure
```
shimlar/
├── packages/
│   ├── core/                    # pure game logic
│   │   ├── src/
│   │   │   ├── entities/        # character, monster, item classes
│   │   │   ├── combat/          # damage calculations, formulas
│   │   │   ├── items/           # item generation, affixes
│   │   │   ├── components/      # entity components
│   │   │   ├── events/          # event system
│   │   │   └── zones/           # zone management
│   │   └── tests/               # comprehensive test suite (21 files)
│   │
│   ├── engine/                  # state management & persistence
│   │   ├── src/
│   │   │   ├── state/           # zustand store with persistence
│   │   │   └── persistence/     # database repository & types
│   │   └── tests/
│   │
│   ├── data/                    # game data files
│   │   ├── src/
│   │   │   ├── affixes/         # affix type definitions
│   │   │   └── monsters/        # monster archetypes
│   │   └── items/
│   │       └── affixes.json     # complete 11k+ line affix database
│   │
│   └── server/                  # rest api server
│       └── src/
│           └── index.ts         # bun server with cors support
```

## design principles

### react client architecture
- server-first state management (react query + zustand)
- component-based ui with proper separation of concerns
- responsive design optimized for desktop gameplay
- real-time updates through polling (websockets future)
- comprehensive error handling and loading states

### api integration  
- rest api for all game state operations
- optimistic updates where appropriate
- client-side caching with server reconciliation
- session management for persistent connections
- automatic retry and error recovery

### testing requirements
- unit tests for all game logic (maintained)
- react component testing with testing library
- api integration tests
- e2e testing for critical user flows
- visual regression testing for ui components

## current status
- **game logic**: complete and tested (278 passing tests)
- **persistence**: implemented with sqlite/postgresql + redis
- **api server**: functional with cors support
- **ready for**: react client development

the foundational systems are solid and ready for a web interface. all game mechanics (combat, items, loot, equipment) are working and thoroughly tested. the next major milestone is building the react application that consumes the api.